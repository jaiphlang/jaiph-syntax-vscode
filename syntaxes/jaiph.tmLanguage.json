{
  "name": "Jaiph",
  "scopeName": "source.jaiph",
  "fileTypes": [
    "jph"
  ],
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#import-statement"
    },
    {
      "include": "#declarations"
    },
    {
      "include": "#if-then-fi"
    },
    {
      "include": "#ensure-run-prompt"
    },
    {
      "include": "#references"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#operators"
    },
    {
      "include": "#shell-fallback"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.jaiph",
          "match": "#.*$"
        }
      ]
    },
    "import-statement": {
      "patterns": [
        {
          "name": "meta.import.jaiph",
          "match": "\\b(import)\\b\\s+(\"(?:\\\\.|[^\"\\\\])*\")\\s+\\b(as)\\b\\s+([A-Za-z_][A-Za-z0-9_]*)",
          "captures": {
            "1": {
              "name": "keyword.control.import.jaiph"
            },
            "2": {
              "name": "string.quoted.double.jaiph"
            },
            "3": {
              "name": "keyword.control.import.jaiph"
            },
            "4": {
              "name": "entity.name.namespace.jaiph"
            }
          }
        }
      ]
    },
    "declarations": {
      "patterns": [
        {
          "name": "meta.declaration.rule.jaiph",
          "match": "\\b(export)\\b\\s+\\b(rule)\\b\\s+([A-Za-z_][A-Za-z0-9_]*)\\s*(\\{)",
          "captures": {
            "1": {
              "name": "storage.modifier.jaiph"
            },
            "2": {
              "name": "storage.type.rule.jaiph"
            },
            "3": {
              "name": "entity.name.function.rule.jaiph"
            },
            "4": {
              "name": "punctuation.section.block.begin.jaiph"
            }
          }
        },
        {
          "name": "meta.declaration.workflow.jaiph",
          "match": "\\b(export)\\b\\s+\\b(workflow)\\b\\s+([A-Za-z_][A-Za-z0-9_]*)\\s*(\\{)",
          "captures": {
            "1": {
              "name": "storage.modifier.jaiph"
            },
            "2": {
              "name": "storage.type.workflow.jaiph"
            },
            "3": {
              "name": "entity.name.function.workflow.jaiph"
            },
            "4": {
              "name": "punctuation.section.block.begin.jaiph"
            }
          }
        },
        {
          "name": "meta.declaration.rule.jaiph",
          "match": "\\b(rule)\\b\\s+([A-Za-z_][A-Za-z0-9_]*)\\s*(\\{)",
          "captures": {
            "1": {
              "name": "storage.type.rule.jaiph"
            },
            "2": {
              "name": "entity.name.function.rule.jaiph"
            },
            "3": {
              "name": "punctuation.section.block.begin.jaiph"
            }
          }
        },
        {
          "name": "meta.declaration.workflow.jaiph",
          "match": "\\b(workflow)\\b\\s+([A-Za-z_][A-Za-z0-9_]*)\\s*(\\{)",
          "captures": {
            "1": {
              "name": "storage.type.workflow.jaiph"
            },
            "2": {
              "name": "entity.name.function.workflow.jaiph"
            },
            "3": {
              "name": "punctuation.section.block.begin.jaiph"
            }
          }
        }
      ]
    },
    "if-then-fi": {
      "patterns": [
        {
          "name": "keyword.control.conditional.jaiph",
          "match": "\\b(if|then|fi)\\b"
        }
      ]
    },
    "ensure-run-prompt": {
      "patterns": [
        {
          "name": "keyword.control.command.jaiph",
          "match": "\\b(ensure|run|prompt)\\b"
        }
      ]
    },
    "references": {
      "patterns": [
        {
          "name": "meta.reference.qualified.jaiph",
          "match": "\\b([A-Za-z_][A-Za-z0-9_]*)(\\.)([A-Za-z_][A-Za-z0-9_]*)\\b",
          "captures": {
            "1": {
              "name": "entity.name.namespace.jaiph"
            },
            "2": {
              "name": "punctuation.accessor.dot.jaiph"
            },
            "3": {
              "name": "variable.other.member.jaiph"
            }
          }
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.jaiph",
          "begin": "\"",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.jaiph"
            }
          },
          "end": "\"",
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.jaiph"
            }
          },
          "patterns": [
            {
              "name": "constant.character.escape.jaiph",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.single.jaiph",
          "begin": "'",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.jaiph"
            }
          },
          "end": "'",
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.jaiph"
            }
          },
          "patterns": [
            {
              "name": "constant.character.escape.jaiph",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.logical.not.jaiph",
          "match": "!"
        },
        {
          "name": "punctuation.terminator.statement.jaiph",
          "match": ";"
        },
        {
          "name": "punctuation.section.block.begin.jaiph",
          "match": "\\{"
        },
        {
          "name": "punctuation.section.block.end.jaiph",
          "match": "\\}"
        }
      ]
    },
    "shell-fallback": {
      "patterns": [
        {
          "name": "meta.shell.command.jaiph",
          "begin": "^(?!\\s*(?:#|import\\b|export\\s+(?:rule|workflow)\\b|rule\\b|workflow\\b|if\\b|then\\b|fi\\b|ensure\\b|run\\b|prompt\\b|\\{|\\}|$))(\\s*)",
          "beginCaptures": {
            "1": {
              "name": "punctuation.whitespace.leading.jaiph"
            }
          },
          "end": "$",
          "patterns": [
            {
              "include": "source.shell"
            }
          ]
        }
      ]
    }
  }
}
